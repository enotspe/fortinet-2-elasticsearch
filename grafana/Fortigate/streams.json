{
    "apiVersion": "dashboard.grafana.app/v2beta1",
    "kind": "Dashboard",
    "metadata": {
        "name": "mak52zx",
        "generation": 5,
        "creationTimestamp": "2025-11-25T15:20:29Z",
        "labels": {},
        "annotations": {}
    },
    "spec": {
        "annotations": [
            {
                "kind": "AnnotationQuery",
                "spec": {
                    "builtIn": true,
                    "enable": true,
                    "hide": true,
                    "iconColor": "rgba(0, 211, 255, 1)",
                    "name": "Annotations & Alerts",
                    "query": {
                        "group": "grafana",
                        "kind": "DataQuery",
                        "spec": {},
                        "version": "v0"
                    }
                }
            }
        ],
        "cursorSync": "Off",
        "description": "",
        "editable": true,
        "elements": {
            "panel-5": {
                "kind": "Panel",
                "spec": {
                    "data": {
                        "kind": "QueryGroup",
                        "spec": {
                            "queries": [
                                {
                                    "kind": "PanelQuery",
                                    "spec": {
                                        "hidden": false,
                                        "query": {
                                            "group": "victoriametrics-logs-datasource",
                                            "kind": "DataQuery",
                                            "spec": {
                                                "editorMode": "code",
                                                "expr": "_stream: {observer.vendor=\"Fortinet\",observer.type=firewall,log.syslog.hostname in(${firewall:doublequote}),fgt.vd in(${vdom:doublequote}),fgt.type in(${type:doublequote}),fgt.subtype in(${subtype:doublequote}),network.direction in(${direction:doublequote})}\n| field_values _stream ",
                                                "queryType": "instant"
                                            },
                                            "version": "v0"
                                        },
                                        "refId": "A"
                                    }
                                }
                            ],
                            "queryOptions": {},
                            "transformations": [
                                {
                                    "kind": "extractFields",
                                    "spec": {
                                        "id": "extractFields",
                                        "options": {
                                            "source": "labels"
                                        }
                                    }
                                },
                                {
                                    "kind": "organize",
                                    "spec": {
                                        "id": "organize",
                                        "options": {
                                            "excludeByName": {},
                                            "includeByName": {
                                                "Line": false,
                                                "Time": false,
                                                "fgt.logid": true,
                                                "fgt.policytype": true,
                                                "fgt.subtype": true,
                                                "fgt.type": true,
                                                "fgt.vd": true,
                                                "log.syslog.hostname": true,
                                                "network.direction": true,
                                                "observer.name": true,
                                                "observer.product": true,
                                                "observer.type": true,
                                                "observer.vendor": true
                                            },
                                            "indexByName": {
                                                "Line": 1,
                                                "Time": 0,
                                                "detected_level": 14,
                                                "fgt.logid": 11,
                                                "fgt.policytype": 10,
                                                "fgt.subtype": 9,
                                                "fgt.type": 8,
                                                "fgt.vd": 7,
                                                "hits": 15,
                                                "labels": 13,
                                                "log.syslog.hostname": 6,
                                                "network.direction": 12,
                                                "observer.name": 5,
                                                "observer.product": 4,
                                                "observer.type": 2,
                                                "observer.vendor": 3
                                            },
                                            "renameByName": {}
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    "description": "",
                    "id": 5,
                    "links": [],
                    "title": "",
                    "transparent": true,
                    "vizConfig": {
                        "group": "table",
                        "kind": "VizConfig",
                        "spec": {
                            "fieldConfig": {
                                "defaults": {
                                    "custom": {
                                        "align": "auto",
                                        "cellOptions": {
                                            "type": "auto"
                                        },
                                        "filterable": true,
                                        "footer": {
                                            "reducers": [
                                                "distinctCount"
                                            ]
                                        },
                                        "inspect": false
                                    },
                                    "thresholds": {
                                        "mode": "absolute",
                                        "steps": [
                                            {
                                                "color": "green",
                                                "value": 0
                                            },
                                            {
                                                "color": "red",
                                                "value": 80
                                            }
                                        ]
                                    }
                                },
                                "overrides": []
                            },
                            "options": {
                                "cellHeight": "sm",
                                "showHeader": true
                            }
                        },
                        "version": "12.4.0-19508498046"
                    }
                }
            }
        },
        "layout": {
            "kind": "RowsLayout",
            "spec": {
                "rows": [
                    {
                        "kind": "RowsLayoutRow",
                        "spec": {
                            "collapse": false,
                            "layout": {
                                "kind": "AutoGridLayout",
                                "spec": {
                                    "columnWidthMode": "standard",
                                    "items": [
                                        {
                                            "kind": "AutoGridLayoutItem",
                                            "spec": {
                                                "element": {
                                                    "kind": "ElementReference",
                                                    "name": "panel-5"
                                                }
                                            }
                                        }
                                    ],
                                    "maxColumnCount": 3,
                                    "rowHeightMode": "tall"
                                }
                            },
                            "repeat": {
                                "mode": "variable",
                                "value": "type"
                            },
                            "title": "$type streams"
                        }
                    }
                ]
            }
        },
        "links": [
            {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": false,
                "keepTime": true,
                "tags": [
                    "fortinet",
                    "fortigate",
                    "ingest",
                    "template"
                ],
                "targetBlank": false,
                "title": "Ingest",
                "tooltip": "",
                "type": "dashboards",
                "url": ""
            },
            {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": false,
                "keepTime": true,
                "tags": [
                    "traffic",
                    "fortinet",
                    "fortigate",
                    "template"
                ],
                "targetBlank": false,
                "title": "Traffic",
                "tooltip": "",
                "type": "dashboards",
                "url": ""
            },
            {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": false,
                "keepTime": true,
                "tags": [
                    "fortinet",
                    "fortigate",
                    "utm",
                    "template"
                ],
                "targetBlank": false,
                "title": "UTM",
                "tooltip": "",
                "type": "dashboards",
                "url": ""
            },
            {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": false,
                "keepTime": true,
                "tags": [
                    "fortinet",
                    "fortigate",
                    "event",
                    "template"
                ],
                "targetBlank": false,
                "title": "Event",
                "tooltip": "",
                "type": "dashboards",
                "url": ""
            }
        ],
        "liveNow": false,
        "preload": false,
        "tags": [
            "fortigate",
            "ingest",
            "fortinet",
            "template"
        ],
        "timeSettings": {
            "autoRefresh": "",
            "autoRefreshIntervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
            ],
            "fiscalYearStartMonth": 0,
            "from": "now-24h",
            "hideTimepicker": false,
            "timezone": "America/Lima",
            "to": "now"
        },
        "title": "Streams [FortiOS]",
        "variables": [
            {
                "kind": "DatasourceVariable",
                "spec": {
                    "allowCustomValue": true,
                    "current": {
                        "text": "",
                        "value": ""
                    },
                    "hide": "dontHide",
                    "includeAll": false,
                    "multi": false,
                    "name": "datasource",
                    "options": [],
                    "pluginId": "victoriametrics-logs-datasource",
                    "refresh": "onDashboardLoad",
                    "regex": "",
                    "skipUrlSync": false
                }
            },
            {
                "datasource": {
                    "name": "${datasource}"
                },
                "group": "victoriametrics-logs-datasource",
                "kind": "AdhocVariable",
                "spec": {
                    "allowCustomValue": true,
                    "baseFilters": [],
                    "defaultKeys": [],
                    "filters": [],
                    "hide": "dontHide",
                    "name": "Filters",
                    "skipUrlSync": false
                }
            },
            {
                "kind": "QueryVariable",
                "spec": {
                    "allValue": "*",
                    "allowCustomValue": true,
                    "current": {
                        "text": "",
                        "value": ""
                    },
                    "definition": "{observer.vendor=\"Fortinet\",observer.type=firewall,fgt.type in(*)}",
                    "hide": "dontHide",
                    "includeAll": true,
                    "multi": true,
                    "name": "firewall",
                    "options": [],
                    "query": {
                        "datasource": {
                            "name": "${datasource}"
                        },
                        "group": "victoriametrics-logs-datasource",
                        "kind": "DataQuery",
                        "spec": {
                            "field": "log.syslog.hostname",
                            "limit": 25,
                            "query": "{observer.vendor=\"Fortinet\",observer.type=firewall,fgt.type in(*)}",
                            "refId": "VictoriaLogsVariableQueryEditor-VariableQuery",
                            "type": "fieldValue"
                        },
                        "version": "v0"
                    },
                    "refresh": "onDashboardLoad",
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": "disabled"
                }
            },
            {
                "kind": "QueryVariable",
                "spec": {
                    "allValue": "*",
                    "allowCustomValue": true,
                    "current": {
                        "text": "",
                        "value": ""
                    },
                    "definition": "_stream:{log.syslog.hostname in (${firewall:doublequote})}",
                    "hide": "dontHide",
                    "includeAll": true,
                    "multi": true,
                    "name": "vdom",
                    "options": [],
                    "query": {
                        "datasource": {
                            "name": "${datasource}"
                        },
                        "group": "victoriametrics-logs-datasource",
                        "kind": "DataQuery",
                        "spec": {
                            "field": "fgt.vd",
                            "limit": 25,
                            "query": "_stream:{log.syslog.hostname in (${firewall:doublequote})}",
                            "refId": "VictoriaLogsVariableQueryEditor-VariableQuery",
                            "type": "fieldValue"
                        },
                        "version": "v0"
                    },
                    "refresh": "onDashboardLoad",
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": "disabled"
                }
            },
            {
                "kind": "CustomVariable",
                "spec": {
                    "allValue": "*",
                    "allowCustomValue": true,
                    "current": {
                        "text": "All",
                        "value": [
                            "$__all"
                        ]
                    },
                    "hide": "dontHide",
                    "includeAll": true,
                    "multi": true,
                    "name": "type",
                    "options": [
                        {
                            "selected": false,
                            "text": "traffic",
                            "value": "traffic"
                        },
                        {
                            "selected": false,
                            "text": "utm",
                            "value": "utm"
                        },
                        {
                            "selected": false,
                            "text": "event",
                            "value": "event"
                        }
                    ],
                    "query": "traffic,utm,event",
                    "skipUrlSync": false
                }
            },
            {
                "kind": "QueryVariable",
                "spec": {
                    "allValue": "*",
                    "allowCustomValue": true,
                    "current": {
                        "text": "",
                        "value": ""
                    },
                    "definition": "_stream: {fgt.type in(${type:doublequote}),log.syslog.hostname in(${firewall:doublequote}),fgt.vd in(${vdom:doublequote})}",
                    "hide": "dontHide",
                    "includeAll": true,
                    "multi": true,
                    "name": "subtype",
                    "options": [],
                    "query": {
                        "datasource": {
                            "name": "${datasource}"
                        },
                        "group": "victoriametrics-logs-datasource",
                        "kind": "DataQuery",
                        "spec": {
                            "field": "fgt.subtype",
                            "limit": 25,
                            "query": "_stream: {fgt.type in(${type:doublequote}),log.syslog.hostname in(${firewall:doublequote}),fgt.vd in(${vdom:doublequote})}",
                            "refId": "VictoriaLogsVariableQueryEditor-VariableQuery",
                            "type": "fieldValue"
                        },
                        "version": "v0"
                    },
                    "refresh": "onDashboardLoad",
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": "disabled"
                }
            },
            {
                "kind": "QueryVariable",
                "spec": {
                    "allValue": "*",
                    "allowCustomValue": true,
                    "current": {
                        "text": "",
                        "value": ""
                    },
                    "definition": "_stream: {fgt.type in(${type:doublequote}),log.syslog.hostname in(${firewall:doublequote}),fgt.vd in(${vdom:doublequote})}",
                    "hide": "dontHide",
                    "includeAll": true,
                    "multi": true,
                    "name": "direction",
                    "options": [],
                    "query": {
                        "datasource": {
                            "name": "${datasource}"
                        },
                        "group": "victoriametrics-logs-datasource",
                        "kind": "DataQuery",
                        "spec": {
                            "field": "network.direction",
                            "limit": 25,
                            "query": "_stream: {fgt.type in(${type:doublequote}),log.syslog.hostname in(${firewall:doublequote}),fgt.vd in(${vdom:doublequote})}",
                            "refId": "VictoriaLogsVariableQueryEditor-VariableQuery",
                            "type": "fieldValue"
                        },
                        "version": "v0"
                    },
                    "refresh": "onDashboardLoad",
                    "regex": "",
                    "skipUrlSync": false,
                    "sort": "disabled"
                }
            },
            {
                "kind": "TextVariable",
                "spec": {
                    "current": {
                        "text": "*",
                        "value": "*"
                    },
                    "description": "Custom LogsQL filter attached to every query.\nSet to \"*\" to not filter.\nSee https://docs.victoriametrics.com/victorialogs/logsql/",
                    "hide": "dontHide",
                    "name": "Logsql",
                    "query": "*",
                    "skipUrlSync": false
                }
            }
        ]
    },
    "status": {}
}